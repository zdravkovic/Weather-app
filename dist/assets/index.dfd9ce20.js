(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function o(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerpolicy&&(n.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?n.credentials="include":a.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(a){if(a.ep)return;a.ep=!0;const n=o(a);fetch(a.href,n)}})();const y=async(r,t)=>{const o={temp:[],description:[],icons:[]};try{const a=await(await fetch(`https://api.openweathermap.org/data/2.5/forecast?units=metric&lat=${r.lat}&lon=${r.lon}&appid=${t.key}`)).json();for(let n=0;n<a.list.length;n+=8)o.temp.push(Math.floor(a.list[n].main.temp)),o.description.push(a.list[n].weather[0].main),o.icons.push(`${a.list[n].weather[0].icon.slice(0,2)}d.png`);return o}catch(i){console.error(i)}},m=async(r,t)=>{try{return await(await fetch(`https://api.openweathermap.org/data/2.5/weather?units=metric&lat=${r.lat}&lon=${r.lon}&appid=${t.key}`).then()).json()}catch(o){console.error(o)}},u={key:"cf49fd067a11578dea17f88bff1fc56d"},d=async r=>{try{const o=await(await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${r}&limit=1&appid=${u.key}`)).json(),i={cityName:o[0].name,lat:o[0].lat,lon:o[0].lon},a=await m(i,u),n=await y(i,u);return{geoData:i,weather:a,forecast:n}}catch{console.log(`Could not get location: ${r}. Please search for some other location`)}},e={inputFormFirst:document.querySelector(".form-first"),inputFieldFirst:document.querySelector(".form-input-first"),inputForm:document.querySelector(".form"),inputField:document.querySelector(".form-input"),firstScreen:document.querySelector(".first-screen"),fsBelgradeDescription:document.querySelector(".fs-belgrade-description"),fsBelgradeTemp:document.querySelector(".fs-belgrade-temp"),fsBelgrade:document.querySelector(".fs-belgrade"),fsBerlinDescription:document.querySelector(".fs-berlin-description"),fsBerlinTemp:document.querySelector(".fs-berlin-temp"),fsBerlin:document.querySelector(".fs-berlin"),fsParisDescription:document.querySelector(".fs-paris-description"),fsParisTemp:document.querySelector(".fs-paris-temp"),fsParis:document.querySelector(".fs-paris"),fsMadridDescription:document.querySelector(".fs-madrid-description"),fsMadridTemp:document.querySelector(".fs-madrid-temp"),fsMadrid:document.querySelector(".fs-madrid"),cityName:document.querySelector(".city"),currentDate:document.querySelector(".date"),mainWeather:document.querySelector(".main-weather"),mainTempIcon:document.querySelector(".main-temp-icon"),mainTemp:document.querySelector(".main-temp"),mainDescription:document.querySelector(".main-description"),forecastDay:document.querySelectorAll(".forecast-day"),forecastIcon:document.querySelectorAll(".forecast-icon"),forecastTemp:document.querySelectorAll(".forecast-temp"),forecastDescription:document.querySelectorAll(".forecast-description"),feelsLike:document.querySelector(".weather-feels-like"),humidity:document.querySelector(".weather-humidity"),sunset:document.querySelector(".weather-sunset"),fiveDays:document.querySelector(".five-day"),windArrow:document.querySelector(".wind-arrow"),windSpeed:document.querySelector(".wind-speed"),pressureArrow:document.querySelector(".pressure-arrow"),pressureText:document.querySelector(".pressure-text"),uvText:document.querySelector(".uv-text"),uvGrade:document.querySelector(".uv-grade"),uvDescription:document.querySelector(".uv-description"),uvDot:document.querySelector(".uv-dot"),airCondition:document.querySelector(".air-condition"),airIcon:document.querySelector(".air-icon"),airDescription:document.querySelector(".air-description"),aqiBg:document.querySelector(".aqi-bg"),aqiText:document.querySelector(".aqi-text"),aqiNum:document.querySelector(".aqi-number"),aqiLine:document.querySelector(".aqi-line"),precipitationMap:document.querySelector(".precipitation-map"),leftSide:document.querySelector(".left-info-wrapper"),rightSide:document.querySelector(".right-info-wrapper"),beforeSearch:document.querySelector(".before-search"),errorMessage:document.querySelector(".error-message"),errorMessageCity:document.querySelector(".error-message__city"),firstScreenError:document.querySelector(".first-screen-error")},f=document.querySelector(".date"),p=()=>{const r=new Date,t=r.toLocaleDateString("en-GB",{day:"numeric"}),o=r.toLocaleDateString("en-GB",{month:"long"}),i=r.toLocaleDateString("en-GB",{year:"numeric"});f.textContent=`${t}. ${o}, ${i}`},S=r=>{const t=r.split(" ");for(let o=0;o<t.length;o++)t[o]=t[o][0].toUpperCase()+t[o].substr(1);return t.join(" ")},g=(r,t)=>{const o=r*1e3,i=parseInt(t)/3600-1;let a="";const n=new Date(o),s=n.toLocaleTimeString("en-GB",{hour12:!1}).slice(0,2),h=n.toLocaleTimeString("en-GB",{hour12:!1}).slice(3,5);return i>=0?a=`${s-Math.abs(i)}:${h}`:a=`${s-Math.abs(i)}:${h}`,a},x=async r=>{const t="3fe98502-6019-4e94-ac6e-190bffd96902";try{return{aqi:(await(await fetch(`https://api.airvisual.com/v2/nearest_city?lat=${r.lat}&lon=${r.lon}&key=${t}`)).json()).data.current.pollution.aqius}}catch(o){console.error(o)}},q=async r=>{C(),e.mainTemp.textContent=`${Math.floor(r.weather.main.temp)}\xB0C`,e.mainDescription.textContent=r.weather.weather[0].main,e.mainTempIcon.src=`./icons/weather-icons/${r.weather.weather[0].icon.slice(0,2)}d.png`,b(),e.forecastIcon.forEach((o,i)=>{o.src=`./icons/weather-icons/${r.forecast.icons[i]}`}),e.forecastTemp.forEach((o,i)=>{o.textContent=`${Math.floor(r.forecast.temp[i])}\xB0C`}),e.forecastDescription.forEach((o,i)=>{o.textContent=r.forecast.description[i]}),e.feelsLike.textContent=`${Math.floor(r.weather.main.feels_like)}\xB0C`,e.humidity.textContent=`${Math.floor(r.weather.main.humidity)}%`,e.sunset.textContent=g(r.weather.sys.sunset,r.weather.timezone),e.windArrow.style.transform=`translate(-50%, -50%) rotate(${r.weather.wind.deg+180}deg)`,e.windSpeed.textContent=Math.ceil(r.weather.wind.speed),e.pressureArrow.style.transform=`translate(-50%, -50%) rotate(${w(r.weather.main.pressure)}deg)`,e.pressureText.textContent=Math.floor(r.weather.main.pressure);const t=await x(r.geoData);t&&v(t)},w=r=>(r-970)/(1050-970)*250-125,C=()=>{const r="all 1s cubic-bezier(.32,0,.24,.99)";e.windArrow.style.transition=r,e.pressureArrow.style.transition=r,e.uvDot.style.transition=r},b=()=>{const r=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],t=new Date().getDay();let o=7,i=0;e.forecastDay.forEach((a,n)=>{a.textContent=`${t>o-1?r[t-o]:r[t+i]}`,o--,i++})},v=r=>{const t={"air-good-bg":"#DDF5E7","air-good-text":"#17B784","air-moderate-bg":"#FAD568","air-moderate-text":"#A78135","air-unhealthySensitive-bg":"#FF9A5D","air-unhealthySensitive-text":"#B75B2F","air-unhealthy-bg":"#FD686E","air-unhealthy-text":"#B52C3E","air-veryUnhealthy-bg":"#A57DB6","air-veryUnhealthy-text":"#654573","air-hazardous-bg":"#A37684","air-hazardous-text":"#6C4051"};e.aqiNum.textContent=r.aqi.toFixed(1),r.aqi<=50?(e.airCondition.textContent="Good",e.airCondition.style.color=t["air-good-text"],e.airIcon.style.stroke=t["air-good-text"],e.aqiText.style.color=t["air-good-text"],e.aqiNum.style.color=t["air-good-text"],e.aqiLine.style.backgroundColor=t["air-good-text"],e.aqiBg.style.backgroundColor=t["air-good-bg"],e.airDescription.textContent="Perfect day for a walk"):r.aqi>50&&r.aqi<=100?(e.airCondition.textContent="Moderate",e.airCondition.style.color=t["air-moderate-text"],e.airIcon.style.stroke=t["air-moderate-text"],e.aqiText.style.color=t["air-moderate-text"],e.aqiNum.style.color=t["air-moderate-text"],e.aqiLine.style.backgroundColor=t["air-moderate-text"],e.aqiBg.style.backgroundColor=t["air-moderate-bg"],e.airDescription.textContent="Sensitive groups should reduce outdoor exercise"):r.aqi>100&&r.aqi<=150?(e.airCondition.textContent="Unhealthy for Sensitive Groups",e.airCondition.style.color=t["air-unhealthySensitive-text"],e.airIcon.style.stroke=t["air-unhealthySensitive-text"],e.aqiText.style.color=t["air-unhealthySensitive-text"],e.aqiNum.style.color=t["air-unhealthySensitive-text"],e.aqiLine.style.backgroundColor=t["air-unhealthySensitive-text"],e.aqiBg.style.backgroundColor=t["air-unhealthySensitive-bg"],e.airDescription.textContent="Sensitive groups should reduce outdoor exercise"):r.aqi>150&&r.aqi<=200?(e.airCondition.textContent="Unhealthy",e.airCondition.style.color=t["air-unhealthy-text"],e.airIcon.style.stroke=t["air-unhealthy-text"],e.aqiText.style.color=t["air-unhealthy-text"],e.aqiNum.style.color=t["air-unhealthy-text"],e.aqiLine.style.backgroundColor=t["air-unhealthy-text"],e.aqiBg.style.backgroundColor=t["air-unhealthy-bg"],e.airDescription.textContent="Avoid outdoor exercise"):r.aqi>200&&r.aqi<=300?(e.airCondition.textContent="Very Unhealthy",e.airCondition.style.color=t["air-veryUnhealthy-text"],e.airIcon.style.stroke=t["air-veryUnhealthy-text"],e.aqiText.style.color=t["air-veryUnhealthy-text"],e.aqiNum.style.color=t["air-veryUnhealthy-text"],e.aqiLine.style.backgroundColor=t["air-veryUnhealthy-text"],e.aqiBg.style.backgroundColor=t["air-veryUnhealthy-bg"],e.airDescription.textContent="Wear a mask outdoors, and avoid outdoor exercise"):r.aqi>300&&(e.airCondition.textContent="Hazardous",e.airCondition.style.color=t["air-hazardous-text"],e.airIcon.style.stroke=t["air-hazardous-text"],e.aqiText.style.color=t["air-hazardous-text"],e.aqiNum.style.color=t["air-hazardous-text"],e.aqiLine.style.backgroundColor=t["air-hazardous-text"],e.aqiBg.style.backgroundColor=t["air-hazardous-bg"],e.airDescription.textContent="Everyone should aviod all outdoor exertion")},D=()=>{e.inputField.value="",e.leftSide.classList.remove("hidden"),e.rightSide.classList.remove("hidden"),e.errorMessage.classList.add("hidden"),e.beforeSearch.classList.add("hidden"),e.cityName.textContent="",e.currentDate.textContent=""},B=()=>{e.inputFieldFirst.value="",e.firstScreenError.classList.add("hidden")},k=async()=>{const r=await d("belgrade"),t=await d("berlin"),o=await d("paris"),i=await d("madrid");e.fsBelgradeDescription.textContent=r.weather.weather[0].main,e.fsBelgradeTemp.textContent=`${Math.ceil(r.weather.main.temp)}\xB0C`,e.fsBerlinDescription.textContent=t.weather.weather[0].main,e.fsBerlinTemp.textContent=`${Math.ceil(t.weather.main.temp)}\xB0C`,e.fsParisDescription.textContent=o.weather.weather[0].main,e.fsParisTemp.textContent=`${Math.ceil(o.weather.main.temp)}\xB0C`,e.fsMadridDescription.textContent=i.weather.weather[0].main,e.fsMadridTemp.textContent=`${Math.ceil(i.weather.main.temp)}\xB0C`;let a;e.fsBelgrade.addEventListener("click",()=>{a="belgrade",l(a,a)}),e.fsBerlin.addEventListener("click",()=>{a="berlin",l(a,a)}),e.fsParis.addEventListener("click",()=>{a="paris",l(a,a)}),e.fsMadrid.addEventListener("click",()=>{a="madrid",l(a,a)})};k();const l=async(r,t)=>{const o=await d(r);typeof o<"u"?(D(),q(o),T(o),e.cityName.textContent=S(t),p(),e.firstScreen.style.width!="0"&&(e.firstScreen.style.width="0",setTimeout(()=>{e.firstScreen.style.animation="opacity-animation .5s forwards",setTimeout(()=>{e.firstScreen.style.display="none"},200)},300))):e.firstScreen.style.display=="none"?(e.inputField.value="",e.leftSide.classList.add("hidden"),e.rightSide.classList.add("hidden"),e.errorMessageCity.innerHTML=`Couldn't find <span class="font-bold">${t.length==0?"anything":`'${t}'`}</span>`,e.errorMessage.classList.remove("hidden"),e.beforeSearch.classList.remove("hidden")):e.firstScreenError.classList.remove("hidden")};[e.inputFormFirst,e.inputForm].forEach(r=>{r.addEventListener("submit",t=>{t.preventDefault();let o;e.firstScreen.style.display!="none"?(o=e.inputFieldFirst.value,B(),l(o,o)):(o=e.inputField.value,l(o,o))})});let c;const T=r=>{c!==void 0&&(c.off(),c.remove()),c=L.map("map",{attributionControl:!1}).setView([r.weather.coord.lat,r.weather.coord.lon],5),L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{maxZoom:10}).addTo(c),L.tileLayer("https://tile.openweathermap.org/map/precipitation_new/{z}/{x}/{y}.png?appid=cf49fd067a11578dea17f88bff1fc56d",{maxZoom:10}).addTo(c)};
